# ğŸ”¥ ç«æŸ´äººæ¸¸æˆ - ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°
ç”¨æˆ·åé¦ˆæ¸¸æˆå¯åŠ¨åæ²¡æœ‰ç”»é¢ï¼Œç‚¹å‡»å¼€å§‹æˆ–å…¨å±æŒ‰é’®éƒ½æ²¡æœ‰ååº”ã€‚

## é—®é¢˜åˆ†æ

### æ ¸å¿ƒé—®é¢˜
1. **åˆå§‹åŒ–é¡ºåºé—®é¢˜** - æ¸¸æˆé€»è¾‘åœ¨canvaså‡†å¤‡å¥½ä¹‹å‰å°±å¼€å§‹æ‰§è¡Œ
2. **æ¸¸æˆå¾ªç¯é€»è¾‘ç¼ºé™·** - æš‚åœ/ç»“æŸçŠ¶æ€ä¸‹è·³è¿‡ç»˜åˆ¶ï¼Œå¯¼è‡´é»‘å±
3. **äº‹ä»¶ç»‘å®šé—®é¢˜** - æŒ‰é’®çš„onclickå±æ€§å¯èƒ½è¢«æµè§ˆå™¨å®‰å…¨ç­–ç•¥é˜»æ­¢
4. **éŸ³é¢‘åˆå§‹åŒ–é—®é¢˜** - éœ€è¦ç”¨æˆ·äº¤äº’æ‰èƒ½åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡

## ä¿®å¤å†…å®¹

### 1. app.py ä¿®å¤ (å®Œæ•´ç‰ˆ)

#### ä¿®å¤ç‚¹1: åˆå§‹åŒ–é¡ºåº
```javascript
// ä¿®å¤å‰
window.addEventListener('load', () => {
    detectDevice();
    setupVirtualControls();
    setupResetButton();
    resetGame();  // å¯èƒ½åœ¨canvaså‡†å¤‡å¥½å‰æ‰§è¡Œ
    resizeCanvas();
    gameLoop();
});

// ä¿®å¤å
window.addEventListener('load', () => {
    detectDevice();
    setupVirtualControls();
    setupResetButton();
    setupBottomButtons();  // æ–°å¢ï¼šåº•éƒ¨æŒ‰é’®äº‹ä»¶ç»‘å®š

    const canvas = document.getElementById('gameCanvas');
    if (canvas && canvas.getContext) {
        resizeCanvas();     // å…ˆè°ƒæ•´å¤§å°
        resetGame();        // å†åˆå§‹åŒ–æ¸¸æˆ
        gameLoop();         // æœ€åå¼€å§‹å¾ªç¯
    }
});
```

#### ä¿®å¤ç‚¹2: æ¸¸æˆå¾ªç¯é€»è¾‘
```javascript
// ä¿®å¤å‰ - æš‚åœ/ç»“æŸæ—¶è·³è¿‡ç»˜åˆ¶
function gameLoop() {
    drawGame();
    if (gameState.paused) {
        requestAnimationFrame(gameLoop);
        return;  // ç›´æ¥è¿”å›ï¼Œä¸æ›´æ–°UI
    }
    // ... æ¸¸æˆé€»è¾‘
}

// ä¿®å¤å - å§‹ç»ˆç»˜åˆ¶ï¼Œç¡®ä¿å¯è§
function gameLoop() {
    drawGame();  // æ€»æ˜¯ç»˜åˆ¶

    if (!gameState.player1 || !gameState.player2) {
        requestAnimationFrame(gameLoop);
        return;
    }

    if (gameState.paused || gameState.gameOver) {
        updateUI();  // å³ä½¿æš‚åœä¹Ÿæ›´æ–°UI
        requestAnimationFrame(gameLoop);
        return;
    }
    // ... æ¸¸æˆé€»è¾‘
}
```

#### ä¿®å¤ç‚¹3: æŒ‰é’®äº‹ä»¶ç»‘å®š
```javascript
// ä¿®å¤å‰ - ä½¿ç”¨onclickå±æ€§ï¼Œå¯èƒ½è¢«é˜»æ­¢
<button onclick="toggleFullscreen()">å…¨å±</button>

// ä¿®å¤å - ä½¿ç”¨äº‹ä»¶ç›‘å¬å™¨ï¼Œç¡®ä¿å¯é 
function setupBottomButtons() {
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    if (fullscreenBtn) {
        fullscreenBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleFullscreen();
        });
        fullscreenBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleFullscreen();
        });
    }
    // ... å…¶ä»–æŒ‰é’®
}
```

#### ä¿®å¤ç‚¹4: drawGame() é˜²å¾¡æ€§ç¼–ç¨‹
```javascript
// ä¿®å¤å‰ - å¯èƒ½å› ç©å®¶æœªåˆå§‹åŒ–è€Œå´©æºƒ
function drawGame() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBackground();
    gameState.player1.draw();  // å¦‚æœplayer1ä¸ºnullä¼šæŠ¥é”™
}

// ä¿®å¤å - å®‰å…¨æ£€æŸ¥
function drawGame() {
    if (!canvas || !ctx) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBackground();

    if (gameState.player1 && gameState.player1.draw) {
        gameState.player1.draw();
    }
    // ... å…¶ä»–ç»˜åˆ¶
}
```

#### ä¿®å¤ç‚¹5: resetGame() å¢å¼º
```javascript
// ä¿®å¤å‰ - å¯èƒ½å› canvaså°ºå¯¸å¼‚å¸¸å¤±è´¥
function resetGame() {
    gameState.player1 = new Stickman(150, 200, ...);
    // ...
}

// ä¿®å¤å - æ£€æŸ¥å¹¶ä¿®å¤canvaså°ºå¯¸
function resetGame() {
    // ç¡®ä¿canvaså°ºå¯¸æ­£ç¡®
    if (canvas.width === 0 || canvas.height === 0) {
        resizeCanvas();
    }

    gameState.player1 = new Stickman(150, 200, ...);
    // ...

    // ç«‹å³æ›´æ–°UI
    updateUI();
}
```

### 2. standalone_test.html ä¿®å¤

#### ä¿®å¤ç‚¹1: åˆå§‹åŒ–æ£€æŸ¥
```javascript
// ä¿®å¤å‰
window.addEventListener('load', () => {
    log('åˆå§‹åŒ–...');
    resetGame();
    gameLoop();
});

// ä¿®å¤å
window.addEventListener('load', () => {
    log('åˆå§‹åŒ–...');

    const canvas = document.getElementById('gameCanvas');
    if (!canvas) {
        log('âŒ Canvasæœªæ‰¾åˆ°');
        return;
    }

    const ctx = canvas.getContext('2d');
    if (!ctx) {
        log('âŒ Contextæœªåˆ›å»º');
        return;
    }

    resetGame();
    gameLoop();
});
```

#### ä¿®å¤ç‚¹2: æ¸¸æˆå¾ªç¯é‡æ„
```javascript
// ä¿®å¤å‰ - é€»è¾‘æ··æ‚
function gameLoop() {
    ctx.clearRect(...);
    drawBackground();
    if (gameState.player1) {
        gameState.player1.update();
        gameState.player1.draw();
    }
    // ... å¤æ‚çš„æ¡ä»¶åˆ¤æ–­
}

// ä¿®å¤å - èŒè´£åˆ†ç¦»
function gameLoop() {
    drawGame();  // æ€»æ˜¯ç»˜åˆ¶

    if (!gameState.player1 || !gameState.player2) {
        requestAnimationFrame(gameLoop);
        return;
    }

    if (gameState.paused || gameState.gameOver) {
        updateStatusDisplay();  // åªæ›´æ–°çŠ¶æ€æ˜¾ç¤º
        requestAnimationFrame(gameLoop);
        return;
    }

    // æ¸¸æˆè¿›è¡Œä¸­æ‰æ›´æ–°é€»è¾‘
    gameState.player1.update();
    gameState.player2.update();
    // ...
}
```

## æµ‹è¯•æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨å¿«é€Ÿæµ‹è¯•å·¥å…·
```bash
# å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨
cd /home/hbpc/stickman-fighter
python3 -c "
import http.server, socketserver, os
os.chdir('/home/hbpc/stickman-fighter')
PORT = 8081
class Handler(http.server.SimpleHTTPRequestHandler):
    def end_headers(self):
        self.send_header('Access-Control-Allow-Origin', '*')
        super().end_headers()
with socketserver.TCPServer(('', PORT), Handler) as httpd:
    print(f'æµ‹è¯•æœåŠ¡å™¨: http://localhost:{PORT}/quick_test.html')
    httpd.serve_forever()
"
```

è®¿é—®: `http://localhost:8081/quick_test.html`

### æ–¹æ³•2: ç›´æ¥æµ‹è¯•å®Œæ•´ç‰ˆ
```bash
# è®¿é—®ç‹¬ç«‹æµ‹è¯•ç‰ˆ
http://localhost:8081/standalone_test.html
```

### æ–¹æ³•3: æµ‹è¯•ä¿®å¤åçš„app.py (éœ€è¦Flask)
```bash
# å®‰è£…Flask
pip install flask==3.0.0

# è¿è¡Œæ¸¸æˆ
python3 app.py

# è®¿é—®
http://localhost:5000
```

## éªŒè¯æ¸…å•

- [ ] é¡µé¢åŠ è½½åèƒ½çœ‹åˆ°Canvaså’ŒèƒŒæ™¯
- [ ] é‡ç½®æŒ‰é’®ç‚¹å‡»åæ˜¾ç¤ºç©å®¶
- [ ] æš‚åœæŒ‰é’®èƒ½æ­£å¸¸æš‚åœ/ç»§ç»­
- [ ] å…¨å±æŒ‰é’®èƒ½è¿›å…¥/é€€å‡ºå…¨å±
- [ ] é”®ç›˜æ§åˆ¶æ­£å¸¸ (WASD, æ–¹å‘é”®, F/J)
- [ ] æ¸¸æˆç»“æŸçŠ¶æ€æ˜¾ç¤ºæ­£å¸¸
- [ ] ç§»åŠ¨ç«¯è§¦æ‘¸æ§åˆ¶æ­£å¸¸

## å…³é”®æ”¹è¿›

1. **å¯é æ€§æå‡** - å¢åŠ äº†å¤šé‡å®‰å…¨æ£€æŸ¥ï¼Œé˜²æ­¢ç©ºæŒ‡é’ˆé”™è¯¯
2. **ç”¨æˆ·ä½“éªŒ** - å³ä½¿åœ¨æš‚åœ/ç»“æŸçŠ¶æ€ä¹Ÿä¿æŒç”»é¢å¯è§
3. **äº‹ä»¶å¤„ç†** - ä½¿ç”¨addEventListeneræ›¿ä»£onclickï¼Œæ›´å¯é 
4. **è°ƒè¯•å‹å¥½** - å¢åŠ äº†è¯¦ç»†çš„console.logè¾“å‡º
5. **ç§»åŠ¨ç«¯æ”¯æŒ** - åŒæ—¶æ”¯æŒè§¦æ‘¸å’Œé¼ æ ‡äº‹ä»¶

## æ–‡ä»¶è¯´æ˜

- `app.py` - å®Œæ•´çš„Flaskåº”ç”¨ (V2.6 æ­¦å™¨ç³»ç»Ÿç‰ˆ)
- `standalone_test.html` - ç‹¬ç«‹HTMLç‰ˆæœ¬ (ç®€åŒ–ç‰ˆ)
- `quick_test.html` - å¿«é€Ÿæµ‹è¯•å·¥å…·
- `ä¿®å¤æŠ¥å‘Š.md` - æœ¬æ–‡ä»¶

## ä¸‹ä¸€æ­¥å»ºè®®

1. å…ˆç”¨ `quick_test.html` éªŒè¯åŸºç¡€åŠŸèƒ½
2. æµ‹è¯• `standalone_test.html` çš„å®Œæ•´æ¸¸æˆä½“éªŒ
3. å¦‚æœéœ€è¦å®Œæ•´åŠŸèƒ½ï¼Œå®‰è£…Flaskåæµ‹è¯• `app.py`
4. å¦‚æœ‰é—®é¢˜ï¼Œæ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-12-27
**ä¿®å¤ç‰ˆæœ¬**: V2.6.1
**çŠ¶æ€**: âœ… å·²ä¿®å¤